---
title: 'C#杂记之伍：数组与集合'
tags:
- CSharp
- 笔记
---

数组可以说是在任何语言中都非常基本的数据结构了。这篇笔记以C#中的数组为引，再延伸到C#的几种集合类(Collections)以及一些相关的概念。

# 数组Array

## 概述

数组存储相同种类的元素，其大小固定，且是顺序存储的。

数组作为一种引用类型(其基类是System.Array)，需要用`new`来创建实例。

```CSharp
//初始化时指定大小
double[] balance = new double[10];

//可以直接赋值来初始化
int [] marks = {99, 98, 92, 97, 95};
```

初始化而尚未赋值的数组，编译器会根据其类型隐式地将所有元素设置为默认值。

数组最大的特点还是能够用下标索引来随机访问其中的元素：

```CSharp
double salary = balance[9];
```

由于实现了`IEnumerable`接口，数组可以使用`foreach...in...`的方式进行迭代访问，还可以使用LINQ，这样就无需获取数组长度再用for循环迭代了。关于这个接口及其相关的内容，我在本文稍后的部分记述。

## 索引器Indexer

索引器（Indexer）可以让各种类、结构、接口实现数组的这种能够用下标索引来访问的功能。

索引器就像一个名为`this`的属性，可以用访问器进行定义。

> 访问器是可在属性上定义的两个方法。其中get方法在读属性时执行；set方法隐含一个传入的`value`参数，在写属性时执行。一个常见的用途是用公开属性的访问器来对私有属性进行读/写。另外也可以在set访问器里对传入值进行范围检查等操作。

索引器的一般定义示例：

```CSharp
element-type this[int index]
{
   // get 访问器
   get
   {
      // 返回 index 指定的值
   }

   // set 访问器
   set
   {
      // 设置 index 指定的值
   }
}
```

比较神奇的是，索引器的索引下标并不是只能使用int，还可以用string。同时索引器又像是一个方法，甚至可以重载，这意味着你可以同时定义以int和string作为索引下标的索引器。

# 集合Collections

## 概述

集合类是定义在`System.Collection`命名空间里的几种类。比起数组，它们实现了几个接口，能更方便用于存储和检索数据。

为了支持无数种类型，非泛型集合把所有的元素都装箱成`object`类的对象来存储。元素的读写总要涉及到装箱与拆箱，在性能上有一定损失。

因此，在引入对泛型的支持后，更好的选择是使用泛型集合来存储数据。以下是几种非泛型和泛型集合：

| 非泛型集合类        | 泛型集合类                         | 描述                   |
| :------------------ | :--------------------------------- | :--------------------- |
| 动态数组 ArrayList  | 列表 List\<T\>                     | 具有动态大小的数组     |
| 哈希表 Hashtable    | 字典 Dictionary\<T\>               | 由键-值对组成的集合    |
| 排序列表 SortedList | 排序列表 SortedList\<Tkey,Tvalue\> | 和字典相似但有排序功能 |
| 队列 Queue          | 队列 Queue\<T\>                    | 先进先出（FIFO）队列   |
| 堆栈 Stack          | 堆栈Stack\<T\>                     | 后进先出（LIFO）队列   |

## List<T>

泛型集合中最常用的就是`List<T>`了。
