---
title: WLAN笔记-贰
tags:
- 计算机网络
- 笔记
- 标准
---
# WLAN组网

与上篇中所写的WLAN基本架构所用的AP+AC不同，这里主要记录AP+Repeater模式的组网。

所谓Repeater，就是为了在面积较大、地形较复杂的环境中，为了让无线信号完整覆盖而引入的中继。主要分为四种：

1. Repeater中继模式
2. Bridge桥接模式
3. Mesh模式
4. 电力猫模式

中继模式和桥接模式下，路由器会通过无线的方式与一台可以上网的无线路由器建立连接，用来放大可以上网的无线路由器上的无线信号。

它们的区别在于：中继模式放大后的无线信号的名称和原来的无线路由器的无线信号**名称一致**，而桥接模式产生的无线信号**名称不一致**。市面上我们买到的“Wi-Fi信号放大器”基本都同时具备中继和桥接两种模式。

Mesh是近年火热起来的一种较为理想的组网模式。它初看上去和中继模式很相似：也是多个路由器组网，并且名称一致。但它们的实现有着本质上的不同：中继模式的网络拓扑是链式，并且需要手动配置；而Mesh组网的网络拓扑是网状，且是自动产生的。

这意味着当有一个节点出现故障或过于繁忙时，中继模式下会有许多设备无法工作，而Mesh网络能让组网中的其他节点进行服务，使整个Mesh网络表现得像是同一台接入设备。这带来另一个优势：当你在Mesh网络覆盖的范围中移动时，始终会由信号最好的路由器与你直接连接，而切换路由器的过程是完全无感的，不像在中继网络中可能需要断开重连，甚至重新分配IP地址(使用socket的程序会断网，比如导致游戏掉线)。

Mesh并不仅仅支持Wi-Fi。它指的是网状网络的组网形式，各种协议的无线和有线网络都可以使用这种组网方式。米家的LED灯泡就有蓝牙Mesh功能，可以简单地实现灯泡的编组。

<!--more-->

另外，前些年还流行一种电力猫模式。这种模式通过电力网络桥接器把网络信号调制到电线上，利用现有电线来解决网络布线问题，相当于同一电表下的每个电源插座都能被作为网线接口，在预埋网线不合理的情况下非常有用。

电力猫虽然部署方便，成本较低，但带宽和时延都不够稳定，而且受用电环境影响很大，三相供电还会使其几乎无法使用。所以当Mesh组网模式普及之后，电力猫已经可以被淘汰了。

# 信道射频

这部分完全是通信相关的知识，不细看了。

802.11a/g/n/ac采用的调制技术是OFDM(关于802.11ax的OFDMA，下一篇再记)。它将信道分成许多正交子信道，在每个子信道上进行窄带调制和传输，这样减少了子信道之间的相互干扰。每个子信道上的信号带宽小于信道的相关带宽，因此每个子信道上的频率选择性衰落是平坦的，大大消除了符号间干扰。

802.11n定义了两种频带宽度：20MHz频宽和40MHz频宽。40MHz频宽将两个20MHz频宽的信道进行捆绑，以获取高于2倍的20MHz频宽的吞吐量。

# 双频优选 Band Steering

这个技术主要与WiFi双频有关。

在802.11n之后，WiFi可以使用2.4GHz和5GHz两种频段。现在，大部分的终端设备和路由器都是同时支持2.4G和5G频段的。

为了结合两个频段的特点，在不同场景下让设备连接这两个不同频段，让所有用户都能够具有较好的吞吐量，有一项叫做Band Steering（频段切换/双频优选）的技术。它主要是通过判断RSSI和带宽载荷两个因素来决定是否切换频段。

切换的逻辑，大致可以用以下的流程图描述：

![Band Steering](https://images.hakurei.red/osE4JgtABSelavN.png)

简单来说，就是：

当RSSI较高，信号较好时，只要5G频段不是过于拥挤、负载不是特别大，尽量切换到带宽更大的5G频段；当RSSI较低，信号较差时，则切换到穿墙效果更好的2.4G。

这种策略能够尽可能地让支持5G的设备通过5G频段连接，可以为仅支持2.4G的老设备腾出更多空间。

以上的策略，是由路由器负责的。Band Steering的实现机制可以参考下面这篇来自高通的文章：

[Qualcomm Research Band-Steering for Dual-Band Wi-Fi Access Points](https://www.qualcomm.com/media/documents/files/band-steering-for-dual-band-wi-fi-access-points.pdf)

根据这种实现机制，路由器的2.4G和5G频段必须具备相同的SSID、密码、加密方式、加密算法。这也是为什么很多厂商的Band Steering功能叫做“双频合一”。

有些较老的设备虽然支持双频，但对双频切换并不友好，它们有的切换会比较慢，有的干脆会掉线。大部分厂商的方案都会考虑到这一点，在设备无法及时切换到新频段时让其重新连接旧频段。

# 波束成形 Beamforming

